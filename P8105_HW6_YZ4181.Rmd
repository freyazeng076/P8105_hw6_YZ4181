---
title: "P8105_HW6_YZ4181"
author: "Yuanyuan Zeng(yz4181)"
date: "11/30/2021"
output: github_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)

library(tidyverse)
library(modelr)
library(mgcv)
```

## Problem 1
```{r}
birthweigh = read_csv("./birthweight.csv") %>% 
  mutate(
    babysex = recode(babysex, `1` = "male", `2` = "female"),
    babysex = factor(babysex),
    frace = recode(frace, 
                   `1` = "White",
                   `2` = "Black",
                   `3` = "Asian",
                   `4` = "Peutro",
                   `8` = "Other"),
    frace = factor(frace),
    mrace = recode(mrace,
                   `1` = "White",
                   `2` = "Black",
                   `3` = "Asian",
                   `4` = "Peutro",
                   `8` = "Other" ),
    mrace = factor(mrace),
    malform = recode(malform, `0` = "Absent", `1` = "Present"),
    malform = factor(malform))
```
* The original data set includes 4342 observations and 20 variables. There is no missing value. The variable of baby sex, father race, mother race, and malformations are re-coded based on the information and converted into factors. Other variables remain as numeric.


#### Propose regression model
```{r}
propose_model= lm(bwt ~ blength + delwt + babysex, data = birthweigh) # regression model

propose_model %>% broom::tidy() %>% 
  select(term, estimate, p.value) %>% 
  mutate(
    term = replace(term, term == "blength", "baby's length"),
    term = replace(term, term == "delwt", "mother's weight at delivery"),
    term = replace(term, term == "babysexmale", "baby sex (male)")
  ) %>% 
  knitr::kable(digits = 3)
```
* The birth weight of the baby depends on baby's length at birth, baby's sex and mother's weight at delivery. We assume there is no interaction between the predictors. Increasing in one unit of length leads to increase baby weight by 134.276 grams. One unit increase of mother's weight at delivery leads to increase baby weight by 2.862 grams. Being males increases weight by 9.658 grams comparing with females.

### Diagnostics
```{r}
birthweigh %>% 
  modelr::add_residuals(propose_model) %>% 
  modelr::add_predictions(propose_model) %>% 
  ggplot(aes(x = pred, y = resid))+
  geom_point()+
  facet_grid(~babysex)+
  labs(
    x = "Fitted Value",
    y = "Residuals",
    title = "Plot of Residuals against Fitted Value"
  )
```
* The plot shows that the residuals randomly fall around 0 for both female and male. There are some points that deviate from 0 which means that those points are away from the fitted values.
